Single-Cell RNA Sequencing Analysis of Mouse Hearts in HFpEF and HFrEF

This repository contains analysis code for single-cell RNA sequencing (scRNA-seq) data from mouse heart samples with heart failure with preserved ejection fraction (HFpEF) and heart failure with reduced ejection fraction (HFrEF).

Data

HFrEF: Gene Expression Omnibus (GEO)——accession number: GSE120064

HFpEF: The data are deposited in the Genome Sequence Archive in the BIG Data Center under the accession code CAR019419.

Pipeline
1. HFpEF and HFrEF data quality control and filtering
Cells were included at a minimum threshold of 500 detected genes and 10,000 UMIs per cell; unique read alignment rate > 50%; and mitochondrial read percentage < 65% (mean + 1.5 s.d.). To mitigate the potential impact of mitochondrial genes on downstream analysis, reads mapped to 37 mitochondrial genes (gene symbols starting with "Mt-") were excluded. Filtered gene–barcode matrices were normalized with the 'SCTransform' function of Seurat, and the top 2,000 variable genes were identified. Gene expression matrices were scaled and centered using the 'ScaleData' function. See details in 01.Quality control and filtering.

2. Integration of HFpEF and HFrEF Datasets
The processed data from both HFpEF and HFrEF studies were normalized using the logarithm-transformation-based normalization by the 'NormalizeData' function with the scale factor of 10,000. Top 2,000 variable features were selected based on the 'SelectIntegrationFeatures' function. A set of anchors between HFpEF and HFrEF studies was identified based on the top 2,000 variable features and neighbor-based algorithm by ‘FindIntegrationAnchors’ function. Finally, the pre-computed anchors were utilized to integrate HFpEF and HFrEF studies using the 'IntegrateData' function.See details in 02. Integration of Datasets.


3. Clustering and cell type annotation
The integrated dataset was scaled and centered features with using a liner model for the regression by using 'ScaleData' function. Second, we computed 30 principal components by running a principal component analysis (PCA) dimensionality reduction. Third, we computed the k.param shared nearest neighbors for the integration study with 30 dimensions of reduction by 'FindNeighbors' function. The final resolution value was set as 0.8. Fourth, we applied the Uniform Manifold Approximation and Projection (UMAP) to reduce dimensions with 30 neighboring points used in local approximations of manifold structure via the uwot R package (v0.1.16). Nine cell types, including cardiomyocytes (CMs), endothelial cells (ECs), fibroblasts (FBs), macrophages (MPs), granulocytes (GNs), endocardial endothelium cells (EcCs), T cells, B cells, and red blood cells (RBCs) were determined according to the expression of known markers from published studies.See details in 03. Clustering and cell type annotation.

4. Cell-cell communication analysis of HFpEF and HFrEF Datasets
The cell-cell interaction analysis was conducted performed using by CellChat R package (v1.6.1). First, we loaded the CellChatDB signaling molecule interaction database (http://www.cellchat.org/cellchatdb/), which includes the known structural composition of ligand-receptor interactions, encompassing 'Secreted Signaling', 'ECM-Receptor', and 'Cell-Cell Contact'. Second, we identified the over-expressed signaling genes associated with each cell group and over-expressed ligand-receptor interactions by the function of 'identifyOverExpressedGenes' and 'identifyOverExpressedInterac-tions'. We calculated cell-cell signaling interaction probability and strength using mass action models between any interacting cell groups. This step is performed independently in HFpEF and HFrEF studies. Fourth, the "hub" was defined as the cell type with the highest differential number of interactions.See details in 04. Cell-cell communication

5. Sub-clustering analysis of cardiomyocyte
Subpopulations were identified for CMs using the 'FindSubCluster' function with default parameters. Highly correlated sub-clusters were merged and identified 8 CM sub-clusters. Also, the markers of each sub-cluster were identified by FindAllMarkers function to check the expression heatmap of sub-clusters markers, identifying of distinct patterns to effectively distinguish between sub-clusters. See details in 05. Sub-clustering of cardiomyocytes.

6. Metabolic pathway analysis in cardiomyocyte
The inference of metabolic activity at individual cell level was performed using the scMetabolism (v0.2.1)[75]. Two metabolic reference datasets were used, 85 metabolism pathways from the KEGG database and 82 metabolism pathways from REACTOME database. First, we performed the homology-based conversion of murine genes to human genes by the nichenetr (v2.0.1, 'convert_mouse_to_human_symbols' command line). Second, the metabolic activity assay of individual cells was calculated by the AUC algorithm based on the expression matrix of genes. Finally, single-cell metabolic activity of specific pathways (fatty acid biosynthesis, fatty acid elongation, fatty acid degradation, fatty acid metabolism) was analyzed. See details in 06. Metabolic pathway analysis

7. Single-cell regulatory network inference and clustering
The gene regulatory network was inferred using on a gene co-expression and motif-based assemble pipeline SCENIC (v1.3.1) following 4 main steps. First, the RNA counts were used as the input. Genes with average expression > 0.03 and detected in at least 1 % of cells were retained. Second, the potential TF-gene pairs were calculated by a co-expression analysis using the GENIE3 (v1.24.0). Third, the regulons were identified by both considering the potential TF-gene pairs and reported TF binding information from a motif database RcisTarget (v1.19.2). Fourth, the activity of each regulon in each cell was calculated by the area under the recovery curve (AUC) and integrated the expression ranks across all genes in a regulon, using the AUCell (v1.24.0). See details in 07. SCENIC analysis.

8. Integration analysis of GWAS and eQTL
HF-susceptibility genes and HF-associated locus identification.This step involves identifying heart failure (HF)-associated lead variants through a search of GWAS Catalog and PubMed; LSD-related locus enrichment. Enrichment analysis is performed to assess the overlap between genes in HF-associated loci and LSD-related regulons. This step calculates odds ratios (OR) and uses Fisher's exact test to determine the statistical significance of the enrichment; Cell-type TG and subtype TG identification; Validation via human heart atlas dataset; Colocalization analysis of GWAS and eQTL. Colocalization analysis is conducted using the coloc R package to investigate colocalized GWAS signals and expression quantitative trait loci (eQTL). This analysis helps to confirm whether the identified genetic variants not only associate with HF but also influence gene expression, providing further evidence of causality. See details in 08. Integration analysis of GWAS and eQTL.
